<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø­Ø±Ø± Ø¨Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©</title>
    
    <style>
        /* (CSS code is mostly unchanged, focusing on adding the new control panel styles) */
        body { 
            margin: 0; 
            font-family: Arial, sans-serif; 
            height: 100vh; 
            overflow: hidden; 
            display: flex;
            flex-direction: column;
        }
        #editor-controls-wrapper {
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            background-color: #1e1e1e;
            color: #d4d4d4;
            box-sizing: border-box;
            padding: 10px;
        }
        
        /* Ù„ÙˆØ­Ø© ØªØºÙŠÙŠØ± Ø§Ù„Ù†Øµ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© */
        .surah-name-control {
            padding: 10px 0;
            border-bottom: 1px solid #3c3c3c;
            margin-bottom: 10px;
            display: flex;
            gap: 10px;
            align-items: center;
        }
        .surah-name-control label {
            color: #ff9d00; /* Ù„ÙˆÙ† Ù…Ù…ÙŠØ² Ù„Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¬Ø¯ÙŠØ¯ */
            font-weight: bold;
            flex-shrink: 0;
        }
        .surah-name-control input[type="text"] {
            flex-grow: 1;
            padding: 5px;
            background-color: #333;
            color: white;
            border: 1px solid #555;
        }
        .surah-name-control button {
            background-color: #ff9d00;
            padding: 6px 15px;
            font-size: 0.9em;
        }

        /* Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        #code-input-box {
            flex-grow: 1; 
            min-height: 200px;
            padding: 15px;
            background-color: #252526;
            color: #d4d4d4;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            border: none;
            box-sizing: border-box;
            outline: none;
        }
        
        /* Ù„ÙˆØ­Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ± */
        .image-upload-panel {
            padding-bottom: 10px;
            border-bottom: 1px solid #3c3c3c;
        }
        .image-upload-panel h4 {
            margin: 5px 0;
            color: #c586c0;
        }
        #base64-output {
            width: 100%;
            min-height: 40px;
            margin-top: 5px;
            font-size: 10px;
            background-color: #333;
            color: #ccc;
            border: none;
        }

        /* Ø§Ù„Ø²Ø± Ø§Ù„Ø¹Ø§Ø¦Ù… Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯ (FAB) */
        #floating-fab {
            position: fixed;
            bottom: 20px;
            right: 20px; 
            z-index: 1001;
            padding: 15px 25px;
            background-color: #28a745; 
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 50px; 
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
            font-weight: bold;
            font-size: 1.1em;
            transition: background-color 0.2s;
        }
        #floating-fab:hover {
            background-color: #1e7e34;
        }

        /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø¨Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø© */
        #full-preview-container {
            width: 100%;
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            background-color: white;
            z-index: 1000;
            display: none; 
            flex-direction: column;
        }
        #live-preview-frame {
            width: 100%;
            flex-grow: 1;
            border: none;
        }
        #exit-button {
            background-color: #dc3545;
            padding: 10px;
            margin: 10px;
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 5px;
        }
        #copy-button { 
            background-color: #007bff;
            padding: 10px;
            margin: 10px;
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 5px;
        }
    </style>
</head>
<body>

    <button id="floating-fab" onclick="togglePreview(true)">ğŸ” Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ÙƒÙˆØ¯</button>

    <div id="editor-controls-wrapper">
        
        <div class="surah-name-control">
            <label for="new-surah-name">ØªØºÙŠÙŠØ± Ø§Ù„Ù†Øµ Ø§Ù„Ø³Ø±ÙŠØ¹:</label>
            <input type="text" id="new-surah-name" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ù†Øµ Ø§Ù„Ø¨Ø¯ÙŠÙ„ Ù‡Ù†Ø§ (Ù…Ø«Ù„ Ø§Ø³Ù… Ø§Ù„Ø³ÙˆØ±Ø©)">
            <button onclick="changeCustomText()">ØªØºÙŠÙŠØ±</button>
        </div>
        
        <div class="image-upload-panel">
            <h4>ğŸ–¼ï¸ ØªØ­ÙˆÙŠÙ„ ØµÙˆØ±Ø© Base64</h4>
            <input type="file" id="image-input" accept="image/*" onchange="handleImageUpload()">
            <textarea id="base64-output" placeholder="Ø³ÙŠØ¸Ù‡Ø± Ø±Ø§Ø¨Ø· Base64 Ù‡Ù†Ø§."></textarea>
        </div>

        <textarea id="code-input-box" oninput="runCode()">
<!DOCTYPE html>
<html>
<head>
    <style>
        h1 { color: #28a745; text-align: center; }
    </style>
</head>
<body>
    <h1>[Ø§Ø³Ù… Ø§Ù„Ø³ÙˆØ±Ø© Ù‡Ù†Ø§]</h1>
    <p>Ù‡Ø°Ù‡ Ø§Ù„Ø¬Ù…Ù„Ø© Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØºÙŠÙŠØ±: [Ø§Ø³Ù… Ø§Ù„Ø³ÙˆØ±Ø© Ù‡Ù†Ø§]</p>
    
    <script>
        // Ø§Ù„ÙƒÙˆØ¯ Ù‡Ù†Ø§...
    </script>
</body>
</html>
        </textarea>
    </div>

    <div id="full-preview-container">
        <div style="display: flex; justify-content: space-between; background-color: #333; padding: 5px;">
            <button id="exit-button" onclick="togglePreview(false)">âŒ Ø®Ø±ÙˆØ¬ ÙˆØ¹ÙˆØ¯Ø© Ù„Ù„ØªØ­Ø±ÙŠØ±</button>
            <button id="copy-button" onclick="copyCode()">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯</button>
        </div>
        
        <iframe id="live-preview-frame"></iframe>
    </div>

    <script>
        // *** 1. Ø¯Ø§Ù„Ø© ØªØºÙŠÙŠØ± Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø®ØµØµ ***
        const PLACEHOLDER = /\[Ø§Ø³Ù… Ø§Ù„Ø³ÙˆØ±Ø© Ù‡Ù†Ø§\]/g; // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ ØªØºÙŠÙŠØ±Ù‡ Ø¹Ø§Ù„Ù…ÙŠØ§Ù‹
        
        function changeCustomText() {
            const editor = document.getElementById('code-input-box');
            const newText = document.getElementById('new-surah-name').value;
            let currentCode = editor.value;
            
            // Ø§Ø³ØªØ¨Ø¯Ø§Ù„ ÙƒÙ„ ØªÙƒØ±Ø§Ø±Ø§Øª Ø§Ù„Ù†Øµ Ø§Ù„Ù‚Ø¯ÙŠÙ… Ø¨Ø§Ù„Ù†Øµ Ø§Ù„Ø¬Ø¯ÙŠØ¯
            const newCode = currentCode.replace(PLACEHOLDER, newText);
            
            // ØªØ­Ø¯ÙŠØ« Ù…Ø±Ø¨Ø¹ Ø§Ù„ÙƒÙˆØ¯ ÙˆØ¨Ø¯Ø¡ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©
            editor.value = newCode;
            runCode();
        }

        // *** 2. Ø¯Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ±) ***
        function runCode() {
            const code = document.getElementById('code-input-box').value;
            document.getElementById('live-preview-frame').srcdoc = code;
        }

        // *** 3. Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø­Ø±Ø± ÙˆØ§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© ***
        function togglePreview(showPreview) {
            const editorWrapper = document.getElementById('editor-controls-wrapper');
            const previewContainer = document.getElementById('full-preview-container');
            const fab = document.getElementById('floating-fab');

            if (showPreview) {
                editorWrapper.style.display = 'none';
                fab.style.display = 'none';
                previewContainer.style.display = 'flex';
                runCode(); 
            } else {
                editorWrapper.style.display = 'flex';
                fab.style.display = 'block';
                previewContainer.style.display = 'none';
            }
        }

        // *** 4. Ø¯Ø§Ù„Ø© ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© (Base64) ***
        function handleImageUpload() {
            const file = document.getElementById('image-input').files[0];
            const outputArea = document.getElementById('base64-output');

            if (!file) { outputArea.value = 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø©.'; return; }

            const reader = new FileReader();
            reader.onload = function(e) {
                outputArea.value = e.target.result;
                outputArea.select(); 
                navigator.clipboard.writeText(e.target.result)
                    .then(() => alert('âœ… ØªÙ… ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© ÙˆÙ†Ø³Ø® Ø±Ø§Ø¨Ø· Base64 ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹! Ø§Ù„Ø¢Ù† Ø§Ù„ØµÙ‚Ù‡ ÙÙŠ Ø®Ø§ØµÙŠØ© src Ù„Ù€ <img>.'))
                    .catch(err => alert('ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ØŒ ÙŠØ¬Ø¨ Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Base64 ÙŠØ¯ÙˆÙŠØ§Ù‹.'));
            };
            reader.readAsDataURL(file); 
        }

        // *** 5. Ø¯Ø§Ù„Ø© Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯ ***
        function copyCode() {
            const code = document.getElementById('code-input-box').value;
            navigator.clipboard.writeText(code)
                .then(() => alert('âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯ ÙƒØ§Ù…Ù„Ø§Ù‹ Ø¨Ù†Ø¬Ø§Ø­!'))
                .catch(err => alert('âŒ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ù†Ø³Ø®.'));
        }
        
        // ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        runCode();
    </script>
</body>
</html>
